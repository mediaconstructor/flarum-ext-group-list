{"version":3,"file":"admin.js","mappings":"MACA,IAAIA,EAAsB,CCA1BA,EAAyBC,IACxB,IAAIC,EAASD,GAAUA,EAAOE,WAC7B,IAAOF,EAAiB,QACxB,IAAM,EAEP,OADAD,EAAoBI,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,CAAM,ECLdF,EAAwB,CAACM,EAASC,KACjC,IAAI,IAAIC,KAAOD,EACXP,EAAoBS,EAAEF,EAAYC,KAASR,EAAoBS,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAE1E,ECNDR,EAAwB,CAACc,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,GCClFf,EAAyBM,IACH,oBAAXa,QAA0BA,OAAOC,aAC1CV,OAAOC,eAAeL,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DX,OAAOC,eAAeL,EAAS,aAAc,CAAEe,OAAO,GAAO,G,wBCL/C,SAASC,EAAgBb,EAAGc,GAKzC,OAJAD,EAAkBZ,OAAOc,eAAiBd,OAAOc,eAAeC,OAAS,SAAyBhB,EAAGc,GAEnG,OADAd,EAAEiB,UAAYH,EACPd,CACT,EACOa,EAAgBb,EAAGc,EAC5B,CCLe,SAASI,EAAeC,EAAUC,GAC/CD,EAASZ,UAAYN,OAAOoB,OAAOD,EAAWb,WAC9CY,EAASZ,UAAUe,YAAcH,EACjCJ,EAAeI,EAAUC,EAC3B,C,OCLA,MAAM,EAA+BG,OAAOC,KAAKC,OAAO,kC,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,4B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,4B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,8B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,sC,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,uB,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,uB,aCUnCC,EAAuB,oBAAAA,IAAA,KAAAC,EAAAD,EAAAnB,UA6GvC,OA7GuCoB,EACxCC,OAAA,WAAS,IAAAC,EAAA,KACLC,KAAKC,MAAQ,KAEbC,IAAIC,QAAQ,CACRC,OAAQ,MACRC,IAAKH,IAAII,MAAMC,UAAU,UAAY,gCACtCC,MAAK,SAAAC,GACJV,EAAKE,MAAQC,IAAIQ,MAAMC,YAAYF,GACnCG,EAAEC,QACN,GACJ,EAAChB,EAEDiB,KAAA,WAAO,IAAAC,EAAA,KACGC,EAAgC,OAAfhB,KAAKC,MAAiB,GAAKD,KAAKC,MAAMgB,KAAI,SAAAC,GAAI,OAAIA,EAAKC,QAAQC,IAAI,IAE1F,OAAOR,EAAE,uBAAwBA,EAAE,QAAS,CACzB,OAAfZ,KAAKC,MAAiBW,EAAE,KAAMA,EAAE,KAAMS,IAAAA,cAAiCrB,KAAKC,MAAMgB,KAAI,SAACC,EAAMI,GAAK,OAAKV,EAAE,KAAM,CAC3GA,EAAE,KAAMM,EAAKC,QAAQI,cACrBX,EAAE,KAAMA,EAAE,uBAAwB,CAC9BY,SAAU,SAAAC,GACNP,EAAKQ,KAAK,CACNC,QAASF,EAAMG,OAAO9C,QACvB0B,MAAK,WACJI,EAAEC,QACN,GACJ,EACA/B,MAAOoC,EAAKS,aAEhBf,EAAE,KAAMA,EAAE,gBAAiB,CACvBiB,QAAS,SAAAJ,GACLA,EAAMK,iBACNf,EAAKgB,WAAWT,GAAQ,EAC5B,GACDU,IAAK,uBACRpB,EAAE,KAAMA,EAAE,gBAAiB,CACvBiB,QAAS,SAAAJ,GACLA,EAAMK,iBACNf,EAAKgB,WAAWT,EAAO,EAC3B,GACDU,IAAK,yBACRpB,EAAE,KAAMA,EAAE,+BAAgC,CACtCiB,QAAS,SAAAJ,GACLA,EAAMK,iBACNZ,EAAI,SAAUV,MAAK,WACfO,EAAKd,MAAMgC,OAAOX,EAAO,GACzBV,EAAEC,QACN,GACJ,GACDmB,IAAK,mBACV,IACFpB,EAAE,KAAMA,EAAE,KAAM,CACZsB,QAAS,GACVC,IAAAA,UAAmB,CAClBC,MAAOlC,IAAImC,WAAWC,MAAMC,8CAC5BC,gBAAiB,UAClBtC,IAAIQ,MAAM+B,IAAI,UACZC,QAAO,SAAAvB,GACJ,OAAIA,EAAMC,OAASuB,IAAAA,WAAmBxB,EAAMC,OAASuB,IAAAA,WAMN,IAAxC3B,EAAe4B,QAAQzB,EAAMC,KACxC,IACCH,KAAI,SAAAE,GAAK,OAAI0B,IAAAA,UAAiB,CAC3BhB,QAAS,WACL3B,IAAIC,QAAQ,CACRC,OAAQ,OACRC,IAAKH,IAAII,MAAMC,UAAU,UAAY,oCACrCuC,KAAM,CACFC,KAAM,CACFC,WAAY,CACRC,QAAS9B,EAAMC,KACf8B,MAAOnC,EAAKd,MAAMkD,YAI/B3C,MAAK,SAAAC,GACJM,EAAKd,MAAMmD,KAAKlD,IAAIQ,MAAMC,YAAYF,IACtCG,EAAEC,QACN,GACJ,GACDM,EAAMI,aAAa,SAElC,EAAC1B,EAEDkC,WAAA,SAAWT,EAAO+B,GAAW,IAAAC,EAAA,KACnBC,EAAWjC,EAAQ+B,EAErBE,EAAW,GAAKA,EAAWvD,KAAKC,MAAMkD,OAAS,GAInDK,QAAQf,IAAI,CACRzC,KAAKC,MAAMqB,GAAOI,KAAK,CACnBwB,MAAOK,IAEXvD,KAAKC,MAAMsD,GAAU7B,KAAK,CACtBwB,MAAO5B,MAEZd,MAAK,WACJ,IAAMiD,EAAOH,EAAKrD,MAAMgC,OAAOX,EAAO,GAEtCgC,EAAKrD,MAAMgC,OAAOsB,EAAU,EAAGE,EAAK,IAEpC7C,EAAEC,QACN,GACJ,EAACjB,CAAA,CA7GuC,GCJtC8D,EAAiB,8BACjBnB,EAAoB,6CAELoB,EAAY,SAAAC,GAAA,SAAAD,IAAA,OAAAC,EAAAC,MAAA,KAAAC,YAAA,KA8B5B,OA9B4B1E,EAAAuE,EAAAC,GAAAD,EAAAlF,UAC7BkD,QAAA,WAAU,IAAA5B,EAAA,KACN,OAAOa,EAAE,0BAA2BA,EAAE,aAAc,CAChDA,EAAE,cAAeA,EAAEmD,IACnBnD,EAAE,cAAe,CACboD,IAAAA,UAAiB,CACbC,MAAmE,MAA5DjE,KAAKkE,QAAQR,EAAiB,kBAAmB,IAAjD1D,GACPwB,SAAU,SAAA1C,GACNiB,EAAKmE,QAAQR,EAAiB,kBAA9B3D,CAAiDjB,EAAQ,IAAM,IACnE,GACDoB,IAAImC,WAAWC,MAAMC,EAAoB,sBAEhD3B,EAAE,cAAe,CACboD,IAAAA,UAAiB,CACbC,MAA+D,MAAxDjE,KAAKkE,QAAQR,EAAiB,mBAA9B1D,GACPwB,SAAU,SAAA1C,GACNiB,EAAKmE,QAAQR,EAAiB,mBAA9B3D,CAAkDjB,EAAQ,IAAM,IACpE,GACDoB,IAAImC,WAAWC,MAAMC,EAAoB,uBAEhD3B,EAAE,cAAe,CACboD,IAAAA,UAAiB,CACbC,MAA+D,MAAxDjE,KAAKkE,QAAQR,EAAiB,mBAA9B1D,GACPwB,SAAU,SAAA1C,GACNiB,EAAKmE,QAAQR,EAAiB,mBAA9B3D,CAAkDjB,EAAQ,IAAM,IACpE,GACDoB,IAAImC,WAAWC,MAAMC,EAAoB,uBAEhD3B,EAAE,cAAeZ,KAAKmE,kBAE9B,EAACR,CAAA,CA9B4B,CAASS,KCT1C,MAAM,EAA+B3E,OAAOC,KAAKC,OAAO,gB,aCEnC0E,EAAa,SAAAC,GAAA,SAAAD,IAAA,QAAAtE,EAAAwE,EAAAT,UAAAX,OAAAqB,EAAA,IAAAC,MAAAF,GAAAG,EAAA,EAAAA,EAAAH,EAAAG,IAAAF,EAAAE,GAAAZ,UAAAY,GAKI,OALJ3E,EAAAuE,EAAA3F,KAAAkF,MAAAS,EAAA,OAAAK,OAAAH,KAAA,MAC9B7C,QAAUiD,IAAAA,UAAgB,WAAU7E,EACpC8E,YAAcD,IAAAA,UAAgB,eAAc7E,EAE5CoB,MAAQyD,IAAAA,OAAa,SAAQ7E,EAC7B+E,QAAUF,IAAAA,QAAc,WAAU7E,CAAA,QALJX,EAAAiF,EAAAC,GAKID,CAAA,CALJ,CAASO,KCG3C1E,IAAI6E,aAAaC,IAAI,8BAA8B,WAC/C9E,IAAIQ,MAAMuE,OAAO,oCAAsCZ,EAEvDnE,IAAIgF,cAAa,IACR,8BACJC,aAAaxB,GACbyB,mBAAmB,CAChBpD,KAAM,eACNI,MAAOlC,IAAImC,WAAWC,MAAM,oDAC5B+C,WAAY,iCACZC,YAAY,GACb,OACX,G","sources":["webpack://@clarkwinkelmann/group-list/webpack/bootstrap","webpack://@clarkwinkelmann/group-list/webpack/runtime/compat get default export","webpack://@clarkwinkelmann/group-list/webpack/runtime/define property getters","webpack://@clarkwinkelmann/group-list/webpack/runtime/hasOwnProperty shorthand","webpack://@clarkwinkelmann/group-list/webpack/runtime/make namespace object","webpack://@clarkwinkelmann/group-list/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@clarkwinkelmann/group-list/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@clarkwinkelmann/group-list/external root \"flarum.core.compat['admin/components/ExtensionPage']\"","webpack://@clarkwinkelmann/group-list/external root \"flarum.core.compat['common/components/Switch']\"","webpack://@clarkwinkelmann/group-list/external root \"flarum.core.compat['common/components/Button']\"","webpack://@clarkwinkelmann/group-list/external root \"flarum.core.compat['common/components/Dropdown']\"","webpack://@clarkwinkelmann/group-list/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@clarkwinkelmann/group-list/external root \"flarum.core.compat['common/models/Group']\"","webpack://@clarkwinkelmann/group-list/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@clarkwinkelmann/group-list/./src/admin/components/GroupListConfigurator.js","webpack://@clarkwinkelmann/group-list/./src/admin/components/SettingsPage.js","webpack://@clarkwinkelmann/group-list/external root \"flarum.core.compat['common/Model']\"","webpack://@clarkwinkelmann/group-list/./src/common/models/GroupListItem.js","webpack://@clarkwinkelmann/group-list/./src/admin/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['admin/components/ExtensionPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Switch'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Dropdown'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Group'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","import Button from 'flarum/common/components/Button';\nimport Dropdown from 'flarum/common/components/Dropdown';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport Group from 'flarum/common/models/Group';\nimport icon from 'flarum/common/helpers/icon';\n\n/* global app, m */\n\nconst translationPrefix = 'clarkwinkelmann-group-list.admin.items.';\n\nexport default class SelectFieldOptionEditor {\n    oninit() {\n        this.items = null;\n\n        app.request({\n            method: 'GET',\n            url: app.forum.attribute('apiUrl') + '/clarkwinkelmann-group-list',\n        }).then(response => {\n            this.items = app.store.pushPayload(response);\n            m.redraw();\n        });\n    }\n\n    view() {\n        const existingGroups = this.items === null ? [] : this.items.map(item => item.group().id());\n\n        return m('table.GroupListTable', m('tbody', [\n            this.items === null ? m('tr', m('td', LoadingIndicator.component())) : this.items.map((item, index) => m('tr', [\n                m('td', item.group().namePlural()),\n                m('td', m('textarea.FormControl', {\n                    onchange: event => {\n                        item.save({\n                            content: event.target.value,\n                        }).then(() => {\n                            m.redraw();\n                        });\n                    },\n                    value: item.content(),\n                })),\n                m('td', m('button.Button', {\n                    onclick: event => {\n                        event.preventDefault(); // Do not close the settings modal\n                        this.moveOption(index, -1);\n                    },\n                }, icon('fas fa-chevron-up'))),\n                m('td', m('button.Button', {\n                    onclick: event => {\n                        event.preventDefault(); // Do not close the settings modal\n                        this.moveOption(index, 1);\n                    },\n                }, icon('fas fa-chevron-down'))),\n                m('td', m('button.Button.Button--danger', {\n                    onclick: event => {\n                        event.preventDefault(); // Do not close the settings modal\n                        item.delete().then(() => {\n                            this.items.splice(index, 1);\n                            m.redraw();\n                        });\n                    },\n                }, icon('fas fa-times'))),\n            ])),\n            m('tr', m('td', {\n                colspan: 5,\n            }, Dropdown.component({\n                label: app.translator.trans(translationPrefix + 'add'),\n                buttonClassName: 'Button',\n            }, app.store.all('groups')\n                .filter(group => {\n                    if (group.id() === Group.MEMBER_ID || group.id() === Group.GUEST_ID) {\n                        // Do not suggest \"virtual\" groups\n                        return false;\n                    }\n\n                    // Do not suggest groups already in use\n                    return existingGroups.indexOf(group.id()) === -1;\n                })\n                .map(group => Button.component({\n                    onclick: () => {\n                        app.request({\n                            method: 'POST',\n                            url: app.forum.attribute('apiUrl') + '/clarkwinkelmann-group-list-items',\n                            body: {\n                                data: {\n                                    attributes: {\n                                        groupId: group.id(),\n                                        order: this.items.length,\n                                    },\n                                },\n                            },\n                        }).then(response => {\n                            this.items.push(app.store.pushPayload(response));\n                            m.redraw();\n                        });\n                    },\n                }, group.namePlural()))))),\n        ]));\n    }\n\n    moveOption(index, moveIndex) {\n        const newIndex = index + moveIndex;\n\n        if (newIndex < 0 || newIndex > this.items.length - 1) {\n            return;\n        }\n\n        Promise.all([\n            this.items[index].save({\n                order: newIndex,\n            }),\n            this.items[newIndex].save({\n                order: index,\n            }),\n        ]).then(() => {\n            const move = this.items.splice(index, 1);\n\n            this.items.splice(newIndex, 0, move[0]);\n\n            m.redraw();\n        });\n    }\n}\n","import ExtensionPage from 'flarum/admin/components/ExtensionPage';\nimport Switch from 'flarum/common/components/Switch';\nimport GroupListConfigurator from './GroupListConfigurator';\n\n/* global app, m */\n\nconst settingsPrefix = 'clarkwinkelmann-group-list.';\nconst translationPrefix = 'clarkwinkelmann-group-list.admin.settings.';\n\nexport default class SettingsPage extends ExtensionPage {\n    content() {\n        return m('.ExtensionPage-settings', m('.container', [\n            m('.Form-group', m(GroupListConfigurator)),\n            m('.Form-group', [\n                Switch.component({\n                    state: this.setting(settingsPrefix + 'showSideNavLink', '1')() === '1',\n                    onchange: value => {\n                        this.setting(settingsPrefix + 'showSideNavLink')(value ? '1' : '0');\n                    },\n                }, app.translator.trans(translationPrefix + 'showSideNavLink')),\n            ]),\n            m('.Form-group', [\n                Switch.component({\n                    state: this.setting(settingsPrefix + 'showAvatarBadges')() === '1',\n                    onchange: value => {\n                        this.setting(settingsPrefix + 'showAvatarBadges')(value ? '1' : '0');\n                    },\n                }, app.translator.trans(translationPrefix + 'showAvatarBadges')),\n            ]),\n            m('.Form-group', [\n                Switch.component({\n                    state: this.setting(settingsPrefix + 'showOnlineStatus')() === '1',\n                    onchange: value => {\n                        this.setting(settingsPrefix + 'showOnlineStatus')(value ? '1' : '0');\n                    },\n                }, app.translator.trans(translationPrefix + 'showOnlineStatus')),\n            ]),\n            m('.Form-group', this.submitButton()),\n        ]));\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","import Model from 'flarum/common/Model';\n\nexport default class GroupListItem extends Model {\n    content = Model.attribute('content');\n    contentHtml = Model.attribute('contentHtml');\n\n    group = Model.hasOne('group');\n    members = Model.hasMany('members');\n}\n","import SettingsPage from './components/SettingsPage';\nimport GroupListItem from '../common/models/GroupListItem';\n\n/* global app */\n\napp.initializers.add('clarkwinkelmann-group-list', () => {\n    app.store.models['clarkwinkelmann-group-list-items'] = GroupListItem;\n\n    app.extensionData\n        .for('clarkwinkelmann-group-list')\n        .registerPage(SettingsPage)\n        .registerPermission({\n            icon: 'fas fa-users',\n            label: app.translator.trans('clarkwinkelmann-group-list.admin.permissions.see'),\n            permission: 'clarkwinkelmann-group-list.see',\n            allowGuest: true,\n        }, 'view');\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","flarum","core","compat","SelectFieldOptionEditor","_proto","oninit","_this","this","items","app","request","method","url","forum","attribute","then","response","store","pushPayload","m","redraw","view","_this2","existingGroups","map","item","group","id","LoadingIndicator","index","namePlural","onchange","event","save","content","target","onclick","preventDefault","moveOption","icon","splice","colspan","Dropdown","label","translator","trans","translationPrefix","buttonClassName","all","filter","Group","indexOf","Button","body","data","attributes","groupId","order","length","push","moveIndex","_this3","newIndex","Promise","move","settingsPrefix","SettingsPage","_ExtensionPage","apply","arguments","GroupListConfigurator","Switch","state","setting","submitButton","ExtensionPage","GroupListItem","_Model","_len","args","Array","_key","concat","Model","contentHtml","members","initializers","add","models","extensionData","registerPage","registerPermission","permission","allowGuest"],"sourceRoot":""}